import{a9 as g,r as w,a as C,t as S,j as e,C as F,b as N,c as P,d as _,F as D,e as l,f as o,g as i,h as c,I as T,i as u,B as p,k,l as E,z as n,m as j,n as Q,aa as q}from"./index-9mv0qMpi.js";import{u as I}from"./useQuery-BCCLhWPj.js";import{P as L,a as M,f as y,C as U,b as B,c as z,S as A,d as H}from"./survey-questions-Fks-NPo-.js";import{T as K}from"./textarea-K-DxoW1C.js";import"./useBaseQuery-CiMuHFwN.js";import"./select-C07YNCzX.js";import"./trash-B4avZ4S_.js";const R=n.object({title:n.string(),description:n.string().nullable(),expire_date:n.date().nullable(),status:n.boolean()});function Y(){const{id:d}=g(),[x,m]=w.useState([]),t=C({resolver:S(R),defaultValues:{title:"",description:"",expire_date:null,status:!1}}),f=async s=>{try{const a=(await j.get("survey/"+s)).data;return t.reset({title:a.data.title,description:a.data.description,expire_date:new Date(a.data.expire_date),status:a.data.status}),m(a.data.questions),a}catch{throw new Error("Failed to fetch surveys")}},h=I({queryKey:["survey",d],queryFn:()=>f(Number(d)),placeholderData:q});function v(s){m(s)}async function b(s){const r={...s,expire_date:s.expire_date?y(s.expire_date,"yyyy-MM-dd hh:mm:ss"):null,questions:x};(await j.put("survey/"+d,r)).status===200&&Q.navigate("/surveys")}return e.jsx("div",{className:"flex w-full h-full items-center justify-center p-2",children:h.isLoading||h.isError?e.jsx("h1",{children:"Loading..."}):e.jsxs(F,{className:"max-w-lg w-full self-center",children:[e.jsx(N,{className:"items-center",children:e.jsx(P,{className:"text-4xl",children:"Update Survey"})}),e.jsx(_,{children:e.jsx(D,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(b),className:"space-y-8",children:[e.jsx(l,{control:t.control,name:"title",render:({field:s})=>e.jsxs(o,{children:[e.jsx(i,{children:"Survey Title"}),e.jsx(c,{children:e.jsx(T,{placeholder:"Title",...s})}),e.jsx(u,{})]})}),e.jsx(l,{control:t.control,name:"description",render:({field:s})=>e.jsxs(o,{children:[e.jsx(i,{children:"Password"}),e.jsx(c,{children:e.jsx(K,{placeholder:"description",...s})}),e.jsx(u,{})]})}),e.jsx(l,{control:t.control,name:"expire_date",render:({field:s})=>e.jsxs(o,{className:"flex flex-col",children:[e.jsx(i,{children:"Expire Date"}),e.jsxs(L,{children:[e.jsx(M,{asChild:!0,children:e.jsx(c,{children:e.jsxs(p,{variant:"outline",className:k("w-full pl-3 text-left font-normal",!s.value&&"text-muted-foreground"),children:[s.value?y(s.value,"PPP"):e.jsx("span",{children:"Survey's expire date."}),e.jsx(U,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),e.jsx(B,{className:"w-auto p-0",align:"start",children:e.jsx(z,{mode:"single",selected:s.value,onSelect:s.onChange,disabled:r=>r<new Date,initialFocus:!0})})]}),e.jsx(u,{})]})}),e.jsx(l,{control:t.control,name:"status",render:({field:s})=>e.jsxs(o,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(i,{className:"text-base",children:"Active"}),e.jsx(E,{children:"Wether to make the survey publicly available"})]}),e.jsx(c,{children:e.jsx(A,{checked:s.value,onCheckedChange:s.onChange})})]})}),e.jsx("div",{children:e.jsx(H,{onQuestionsUpdate:v,questions:x})}),e.jsx(p,{type:"submit",children:"Submit"})]})})})]})})}export{Y as default};
